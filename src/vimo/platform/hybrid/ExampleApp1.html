<!doctype html>
<html><head>
    <title>WebViewJavascriptBridge Demo</title>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0">
        <style type='text/css'>
            html { font-family:Helvetica; color:#222; }
            h1 { color:steelblue; font-size:24px; margin-top:24px; }
            button { margin:0 3px 10px; font-size:12px; }
            .logLine { border-bottom:1px solid #ccc; word-wrap: break-word; word-break:break-all; padding:4px 2px; font-family:courier; font-size:11px; }
            </style>
</head>
<body>
    <div id='runLog'></div>
    <script>
        var dd = {}
        window.onerror = function(err) {
            log('window.onerror: ' + err)
        }
    
        /*function connectWebViewJavascriptBridge(callback) {
            if (window.WebViewJavascriptBridge) {
                callback(WebViewJavascriptBridge)
            } else {
                document.addEventListener('WebViewJavascriptBridgeReady', function() {
                    callback(WebViewJavascriptBridge)
                }, false)
            }
        }*/
    
        var uniqueId = 1
        function log(message, data) {
            var log = document.getElementById('log')
            var el = document.createElement('div')
            el.className = 'logLine'
            el.innerHTML = uniqueId++ + '. ' + message + ':<br/>' + JSON.stringify(data)
            if (log.children.length) { log.insertBefore(el, log.children[0]) }
            else { log.appendChild(el) }
        }

        /*connectWebViewJavascriptBridge(function(bridge) {
                        
            bridge.init(function(message, responseCallback) {
                log('JS got a message', message)
                var data = { 'Javascript Responds':'Wee!' }
                log('JS responding with', data)
                responseCallback(data)
            })
                                       
            bridge.registerHandler('testJavascriptHandler', function(data, responseCallback) {
                log('ObjC called testJavascriptHandler with', data)
                var responseData = { 'Javascript Says':'Right back atcha!' }
                log('JS responding with', responseData)
                responseCallback(responseData)
            })

            var button = document.getElementById('buttons').appendChild(document.createElement('button'))
                button.innerHTML = 'Send message to ObjC'
                button.onclick = function(e) {
                    e.preventDefault()
                    var data = 'Hello from JS button'
                    log('JS sending message', data)
                    bridge.send(data, function(responseData) {
                    log('JS got response', responseData)
                })
            }

            document.body.appendChild(document.createElement('br'))

            var callbackButton = document.getElementById('buttons').appendChild(document.createElement('button'))
            callbackButton.innerHTML = 'Fire testObjcCallback'
            callbackButton.onclick = function(e) {
                e.preventDefault()
                log('JS calling handler "testObjcCallback"')
                bridge.callHandler('testObjcCallback', {'foo': 'bar'}, function(response) {
                    log('JS got response', response)
                })
            }
                                       
            document.body.appendChild(document.createElement('br'))
           
            var testButton = document.getElementById('buttons').appendChild(document.createElement('button'))
            testButton.innerHTML = 'alert test'
            testButton.onclick = function(e) {
            e.preventDefault()
                dd.device.notification.confirm({
                    message : '你爱我吗',
                    title: "提示",//可传空
                    buttonLabels: ['爱', '不爱'],
                    onSuccess : function(data) {
                        log('confirm success, user choose index', data.buttonIndex)},
                    onFail : function(err) {
                        log('alert called failed', err) },
                    onCancel : function(err) {
                        log('user canceled', err) }})
            }
        })*/

        !function(This) {
            "use strict";
            function mergeData(data, newData, replace) {
                for (var key in newData) replace ? data[key] = newData[key] : data[key] = (void 0 !== data[key] ? data[key] : newData[key])
            }
           
            function callHandlerEx(handlerName, data) {
                if ("undefined" == typeof window.WebViewJavascriptBridge) {
                    return console.log("WebViewJavascriptBridge 未定义");
                }
                var handleData = data || {},
                onSuccess = function(result) {
                    console.log("默认成功回调", handlerName, result)
                },
                onFail = function(result) {
                    console.log("默认失败回调", handlerName, result)
                },
                onCancel = function() {};
                handleData.onSuccess && (onSuccess = handleData.onSuccess, delete handleData.onSuccess),
                handleData.onFail && (onFail = handleData.onFail, delete handleData.onFail),
                handleData.onCancel && (onCancel = handleData.onCancel, delete handleData.onCancel);
                var responseCallback = function(responseData) {
                    var response = JSON.parse(responseData || '')
                    var errorCode = response.errorCode
                    var result = response.result;
                    log('response from native code', response)
                    "0" === errorCode ? onSuccess && onSuccess.call(null, result) : "-1" === errorCode ? onCancel && onCancel.call(null, result) : onFail && onFail.call(null, result, errorCode)
                },
                registered = false;
                
                switch (handlerName) {
                    case "device.notification.alert":
                        mergeData(handleData, {
                            title: "",
                            buttonName: "确定"
                        });
                    break;
                    case "device.notification.confirm":
                    case "device.notification.prompt":
                        mergeData(handleData, {
                            title: "",
                            buttonLabels: ["确定", "取消"]
                        });
                    break;
                    case "device.notification.vibrate":
                        mergeData(handleData, {
                            duration: 300
                        });
                    break;
                    case "device.accelerometer.watchShake":
                        bridgeModuleDict.ios && (registered = true, handleData.sensitivity = 3.2);
                    break;
                    case "biz.util.openLink":
                        mergeData(handleData, {
                            credible: true,
                            showMenuBar: true
                        });
                    break;
                    case "biz.contact.choose":
                        mergeData(handleData, {
                            multiple: true,
                            startWithDepartmentId: 0,
                            users: [],
                            corpId: appConfig && appConfig.corpId || ""
                        });
                    break;
                    case "biz.contact.complexChoose":
                        mergeData(handleData, {
                            startWithDepartmentId: 0,
                            selectedUsers: [],
                            selectedDepartments: [],
                            corpId: appConfig && appConfig.corpId || ""
                        });
                    break;
                    case "biz.navigation.setLeft":
                    case "biz.navigation.setRight":
                        bridgeModuleDict.ios && (registered = true),
                        mergeData(handleData, {
                            show: true,
                            control: false,
                            showIcon: true,
                            text: ""
                        });
                    break;
                    case "ui.pullToRefresh.enable":
                        bridgeModuleDict.ios && (registered = true);
                    break;
                    case "device.notification.toast":
                        mergeData(handleData, {
                            text: "toast",
                            duration: bridgeModuleDict.android ? (bridgeModuleDict.duration - 3 > 0) + 0 : 3,
                            delay: 0
                        });
                    break;
                    case "device.notification.showPreloader":
                        mergeData(handleData, {
                            text: "加载中...",
                            showIcon: true
                        });
                    break;
                    case "biz.util.uploadImage":
                        mergeData(handleData, {
                            multiple: false
                        });
                    break;
                    case "biz.util.scan":
                        mergeData(handleData, {
                            type: "qrCode"
                        });
                    break;
                    case "biz.map.search":
                        mergeData(handleData, {
                            scope: 500
                        });
                    break;
                    case "biz.util.ut":
                        var j, l = handleData.value;
                        if (l && "Object" == bridgeModuleDict.type(l) && window.JSON) {
                            if (bridgeModuleDict.ios) l = JSON.stringify(l);
                            else if (bridgeModuleDict.android) {
                            for (var m in l) j.push(m + "=" + l[m]);
                            l = j.join(",")
                            }
                        } else window.JSON || (l = "");
                        mergeData(handleData, {
                            value: l
                        },
                        true);
                    break;
                    case "internal.util.encryData":
                        var j, n = handleData.data;
                        if ("Object" == bridgeModuleDict.type(n)) {
                            for (var m in n) j.push(m + "=" + n[m]);
                            n = j.json("&")
                        }
                        mergeData(handleData, {
                            data: n
                        },
                        true);
                    break;
                    case "biz.navigation.setIcon":
                        bridgeModuleDict.ios && (registered = true),
                            mergeData(handleData, {
                            showIcon: true,
                            iconIndex: "1"
                        });
                    break;
                    case "dd.biz.util.encrypt":
                        mergeData(handleData, {
                             corpId:'test',//必传,
                             data: {   //要加密的数据
                                   h :'hello',
                                   w : 'world'
                             },

                        });
                    break;
                    case "dd.biz.util.decrypt":
                        mergeData(handleData, {
                            orpId:'test',//
                            data: {
                                  h :'1_1_29ae62f3a655aecd14b639a5aa50d3408e21c1ff668c71ea78f3d5cc340a9880',
                                  w :'1_1_62983a28e92e59e2d889eb6bbba872cc141dd7b495e7a076847125fe70472e1e'
                            },
                        });
                    break;
                    case "biz.customContact.multipleChoose":
                    case "biz.customContact.choose":
                        mergeData(handleData, {
                            isShowCompanyName: false
                        })
                }

                var handleFullData = {handlerName : handlerName, params : handleData}
                if (bridgeModuleDict.android) {
                    var handleNameSplit = handlerName.split("."),
                    popName = handleNameSplit.pop(),
                    funcName = handleNameSplit.join(".");
                    WebViewJavascriptBridgeAndroid(onSuccess, onFail, funcName, popName, handleFullData)
                } else if (bridgeModuleDict.ios) {
                    if (registered) {
                        WebViewJavascriptBridge.registerHandler(handlerName,
                            function(data, callback) {
                                responseCallback({
                                     errorCode: "0",
                                     errorMessage: "成功",
                                     result: data
                                 }),
                                callback && callback({
                                     errorCode: "0",
                                     errorMessage: "成功"
                                })
                            }
                        )
                        WebViewJavascriptBridge.callHandler("dd.native.call", handleFullData)
                    } else {
                        WebViewJavascriptBridge.callHandler("dd.native.call", handleFullData, responseCallback)
                    }
                } /*&& (registered ? (runLog('bridge registerHandler begin.'), WebViewJavascriptBridge.registerHandler(handlerName,
                    function(data, responseCallback) {
                        responseCallback({
                            errorCode: "0",
                            errorMessage: "成功",
                            result: data
                        }),
                        responseCallback && responseCallback({
                            errorCode: "0",
                            errorMessage: "成功"
                        })
                    }), WebViewJavascriptBridge.callHandler(handlerName, handleData), runLog('bridge registerHandler called.')) : (WebViewJavascriptBridge.callHandler(handlerName, handleData, responseCallback), runLog('WebViewJavascriptBridge callHandler:' + handlerName)))*/
            }
            
            var actionHandleArray = ["backbutton", "online", "offline", "pause", "resume", "swipeRefresh"]
            var handleNameArray = ["device.notification.alert",
                                   "device.notification.confirm",
                                   "device.notification.prompt",
                                   "device.notification.vibrate",
                                   "device.accelerometer.watchShake",
                                   "device.accelerometer.clearShake",
                                   "biz.util.open",
                                   "biz.util.openLink",
                                   "biz.util.share",
                                   "biz.util.ut",
                                   "biz.util.datepicker",
                                   "biz.util.timepicker",
                                   "biz.user.get",
                                   "biz.navigation.setLeft",
                                   "biz.navigation.setRight",
                                   "biz.navigation.setTitle",
                                   "biz.navigation.setMenu",
                                   "biz.navigation.back",
                                   "device.notification.toast",
                                   "device.notification.showPreloader",
                                   "device.notification.hidePreloader",
                                   "device.geolocation.get",
                                   "biz.util.uploadImage",
                                   "biz.util.previewImage",
                                   "ui.input.plain",
                                   "device.notification.actionSheet",
                                   "biz.util.qrcode",
                                   "device.connection.getNetworkType",
                                   "runtime.info",
                                   "biz.ding.post",
                                   "biz.telephone.call",
                                   "biz.chat.chooseConversation",
                                   "biz.contact.createGroup",
                                   "biz.util.datetimepicker",
                                   "biz.util.chosen",
                                   "device.base.getUUID",
                                   "device.base.getInterface",
                                   "device.launcher.checkInstalledApps",
                                   "device.launcher.launchApp",
                                   "ui.progressBar.setColors",
                                   "runtime.permission.requestAuthCode",
                                   "runtime.permission.requestJsApis",
                                   "ui.pullToRefresh.enable",
                                   "ui.pullToRefresh.stop",
                                   "ui.pullToRefresh.disable",
                                   "ui.webViewBounce.enable",
                                   "ui.webViewBounce.disable",
                                   "biz.chat.getConversationInfo",
                                   "biz.map.search",
                                   "biz.map.locate",
                                   "biz.util.scan",
                                   "biz.contact.choose",
                                   "biz.contact.complexChoose",
                                   "util.localStorage.getItem",
                                   "util.localStorage.setItem",
                                   "util.localStorage.removeItem",
                                   "biz.navigation.createEditor",
                                   "biz.navigation.finishEditor",
                                   "biz.chat.pickConversation",
                                   "device.notification.modal",
                                   "biz.navigation.setIcon",
                                   "biz.navigation.close",
                                   "biz.util.uploadImageFromCamera",
                                   "internal.lwp.call",
                                   "device.geolocation.openGps",
                                   "biz.util.test",
                                   "internal.microapp.checkInstalled",
                                   "internal.user.getRole",
                                   "device.notification.extendModal",
                                   "internal.request.lwp",
                                   "biz.user.secretID",
                                   "internal.util.encryData",
                                   "biz.customContact.choose",
                                   "biz.customContact.multipleChoose",
                                   "biz.util.encrypt",
                                   "biz.util.decrypt",
                                   "device.audio.startRecord",
                                   "device.audio.stopRecord",
                                   "device.audio.onRecordEnd",
                                   "device.audio.play",
                                   "device.audio.pause",
                                   "device.audio.resume",
                                   "device.audio.stop",
                                   "device.audio.onPlayEnd",
                                   "device.audio.translateVoice",
                                   "device.audio.download",
                                   "biz.user.getUserInfo"
                                   ]
            var f = "0.5.0"
            var userAgent = This.navigator.userAgent;
            var userAgentMatch = userAgent.match(/AliApp\(\w+\/([a-zA-Z0-9.-]+)\)/);
            null === userAgentMatch && (userAgentMatch = userAgent.match(/DingTalk\/([a-zA-Z0-9.-]+)/));
            var appVersion = userAgentMatch && userAgentMatch[1],
            actionHandleRegister = false,
            appConfig = null,
            requestJsApisHandle = "runtime.permission.requestJsApis",
            errorCallback = null,
            n = false;
            
            var bridgeModuleDict = {
                ios: true,
                android: false,
                version: appVersion,
                support: "1.2.2" === appVersion || "1.3.2" === appVersion,
                ability: "",
                config: function(conf) {
                    conf && (appConfig = {
                        corpId: conf.corpId,
                        appId: conf.appId || -1,
                        timeStamp: conf.timeStamp,
                        nonceStr: conf.nonceStr,
                        signature: conf.signature,
                        jsApiList: conf.jsApiList
                    },
                    conf.agentId && (appConfig.agentId = conf.agentId))
                },
                error: function(callback) {
                    errorCallback = callback
                },
                ready: function(callback) {
                    var handleReady = function(bridge) {
                        if (!bridge) return console.log("bridge初始化失败");
                        if (null !== appConfig && appConfig.signature) {
                            if (bridgeModuleDict.ios) bridge.callHandler(requestJsApisHandle, appConfig,
                                function(responseData) {
                                    var response = responseData || {},
                                    errorCode = response.errorCode,
                                    errorMessage = response.errorMessage || "";
                                    response.result;
                                    "0" === errorCode ? callback(bridge) : setTimeout(function() {
                                        errorCallback && errorCallback({
                                            message: "权限校验失败 " + errorMessage,
                                            errorCode: 3
                                        })
                                    })
                                });
                            else if (bridgeModuleDict.android) {
                                var requestApisSplite = requestJsApisHandle.split("."),
                                handlePop = requestApisSplite.pop(),
                                handleFunc = requestApisSplite.join(".");
                                bridge(function() {
                                    callback(bridge)
                                },
                                function(response) {
                                    setTimeout(function() {
                                        var responseTemp = response && response.errorMessage || "";
                                        errorCallback && errorCallback({
                                            message: "权限校验失败 " + responseTemp,
                                            errorCode: 3
                                        })
                                    })
                                },
                                handleFunc, handlePop, appConfig)
                            }
                        } else {
                            callback(bridge);
                        }
                        if (actionHandleRegister === false && (actionHandleRegister = true, actionHandleArray.forEach(function(handleName) {
                            bridgeModuleDict.ios && bridge.registerHandler(handleName,
                                function(data, responseCallback) {
                                    var htmlEvent = document.createEvent("HTMLEvents");
                                    htmlEvent.data = data,
                                    htmlEvent.initEvent(handleName),
                                    document.dispatchEvent(htmlEvent),
                                    responseCallback && responseCallback({
                                        errorCode: "0",
                                        errorMessage: "成功"
                                    })
                                })
                        }), null === appConfig)) {
                            var confValue = {
                                url: encodeURIComponent(window.location.href),
                                js: appConfig,
                                cid: appConfig && appConfig.corpId || ""
                            };
                            bridgeModuleDict.biz.util.ut({
                                key: "dd_open_js_monitor",
                                value: JSON.stringify(confValue),
                                onSuccess: function(result) {}
                            })
                        }
                    };
                    if (bridgeModuleDict.ios && This.WebViewJavascriptBridge) {
                        try {
                            WebViewJavascriptBridge.init(function(message, responseCallback) {})
                        } catch(error) {
                            console.log(error.message)
                        }
                        return handleReady(WebViewJavascriptBridge)
                    }
                    if (bridgeModuleDict.android && This.WebViewJavascriptBridgeAndroid) return handleReady(WebViewJavascriptBridgeAndroid);
                    if (bridgeModuleDict.ios) {
                        document.addEventListener("WebViewJavascriptBridgeReady",
                        function() {
                            if ("undefined" == typeof WebViewJavascriptBridge) return console.log("WebViewJavascriptBridge 未定义");
                            try {
                                WebViewJavascriptBridge.init(function(message, responseCallback) {})
                            } catch(error) {
                                console.log(error.message)
                            }
                            n = true,
                            handleReady(WebViewJavascriptBridge)
                        },
                        false);
                    } else {
                        if (!bridgeModuleDict.android) return console.log("很抱歉，尚未支持您所持设备");
                        var bridgeCallback = function() {
                            try {
                                This.WebViewJavascriptBridgeAndroid = This.nuva.require(),
                                n = true,
                                handleReady(WebViewJavascriptBridgeAndroid)
                            } catch(error) {
                                console.log("window.nuva.require出错", error.message),
                                handleReady(null)
                            }
                        };
                        This.nuva ? bridgeCallback() : document.addEventListener("runtimeready",
                        function() {
                            bridgeCallback()
                        },
                        false)
                    }
                },
                type: function(typeName) {
                    return Object.prototype.toString.call(typeName).match(/^\[object\s(.*)\]$/)[1]
                },
                compareVersion: function(a, b, c) {
                    if ("string" != typeof a || "string" != typeof b) return ! 1;
                    for (var d, e, f = a.split("."), g = b.split("."); d === e && g.length > 0;) d = f.shift(),
                    e = g.shift();
                    return c ? (0 | e) >= (0 | d) : (0 | e) > (0 | d)
                }
            };

            var registerModule = function(functionName, callbackFunc) {
                for (var nameSplit = functionName.split("."), moduleDict = bridgeModuleDict, index = 0, splitLen = nameSplit.length; splitLen > index; index++) index === splitLen - 1 && (moduleDict[nameSplit[index]] = callbackFunc),
                "undefined" == typeof moduleDict[nameSplit[index]] && (moduleDict[nameSplit[index]] = {}),
                moduleDict = moduleDict[nameSplit[index]]
            };
            
            handleNameArray.forEach(function(handleName) {
                registerModule(handleName, function(params) {
                    callHandlerEx(handleName, params)
                })
            }),
            bridgeModuleDict.__ns = registerModule,
            "object" == typeof module && module && "object" == typeof module.exports ? module.exports = bridgeModuleDict : "function" == typeof define && (define.amd || define.cmd) ? define("dd", [], function() {
                return bridgeModuleDict
            }) : This.dd = bridgeModuleDict
        } (this)
    
        dd.ready(function(bridge) {
                 
             bridge.registerHandler('dd.javascript.call', function(data, responseCallback) {
                 log('ObjC called dd.javascript.call with', data)
                 var responseData = { 'Javascript Says':'Right back atcha!' }
                 log('JS responding with', responseData)
                 responseCallback(responseData)
             })
                 
             document.body.appendChild(document.createElement('br'))
             
            //功能1: alert 弹窗
             var confirmButton = document.getElementById('buttons').appendChild(document.createElement('button'))
             confirmButton.innerHTML = 'confirm'
             confirmButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.notification.confirm({
                    message : '你爱我吗',
                    title: "提示",//可传空
                    buttonLabels: ['爱', '不爱'],
                    onSuccess : function(data) {
                        log('confirm success, user confirm at index', data.buttonIndex)},
                    onFail : function(err) {
                        log('alert called failed', err) },
                    onCancel : function(err) {
                        log('user canceled', err) }})
             }
                 
             document.body.appendChild(document.createElement('br'))
                 
             //功能2: 获取UUID
             var uuidButton = document.getElementById('buttons').appendChild(document.createElement('button'))
             uuidButton.innerHTML = 'getUUID'
             uuidButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.base.getUUID({
                    onSuccess : function(data) {
                        log('getUUID success', data.uuid)
                    },
                    onFail : function(err) { log('getUUID called failed', err) }
                });
            }

             document.body.appendChild(document.createElement('br'))
             
            //功能3: actionSheet 弹窗
             var actionSheetButton = document.getElementById('buttons').appendChild(document.createElement('button'))
             actionSheetButton.innerHTML = 'actionSheet'
             actionSheetButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.notification.actionSheet({
                    title: "谁是最棒哒？", //标题
                    cancelButton: '取消', //取消按钮文本
                    otherButtons: ["孙悟空","猪八戒","唐僧","沙和尚"],
                    onSuccess : function(data) {
                        log('actionSheet success, user confirm at index', data.buttonIndex)
                    },
                    onFail : function(err) { log('actionSheet called failed', err) },
                    onCancel : function(err) { log('user canceled', err) }
                })
             }
            // vibrate 震动
            var uuidButton = document.getElementById('buttons').appendChild(document.createElement('button'))
            uuidButton.innerHTML = 'vibrate'
            uuidButton.onclick = function(e) {
                e.preventDefault()
                dd.device.notification.vibrate({
                   onSuccess : function(data) {
                         log('vibrate success, user confirm at index', data.buttonIndex)
                    },
                   onFail : function(err) { log('vibrate called failed', err) },
                })
             }
            //新增功能：device.notification.prompt
            var actionSheetButton = document.getElementById('buttons').appendChild(document.createElement('button'))
            actionSheetButton.innerHTML = 'prompt'
            actionSheetButton.onclick = function(e) {
            e.preventDefault()
            dd.device.notification.prompt({
                title: "提示", //标题
                cancelButton: '继续', //取消按钮文本
                otherButtons: '不玩了',
                    onSuccess : function(data) {
                          log('actionSheet success, user confirm at index', data.buttonIndex)
                          },
                    onFail : function(err) {
                          log('actionSheet called failed', err) },
                    onCancel : function(err) { log('user canceled', err) }
                  })
             }
                 //显示进度条
            var actionSheetButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 actionSheetButton.innerHTML = 'showPreloader'
                 actionSheetButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.notification.showPreloader({
                                                      onSuccess : function(data) {
                                                      log('showPreloader success, user confirm at index', data.buttonIndex)
                                                      },
                                                      onFail : function(err) {
                                                      log('showPreloader called failed', err) },
                                                      onCancel : function(err) { log('user canceled', err) }
                                                      })
                 }
                 //隐藏进度条
            var actionSheetButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 actionSheetButton.innerHTML = 'hidePreloader'
                 actionSheetButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.notification.hidePreloader({
                                                      onSuccess : function(data) {
                                                      log('hidePreloader success, user confirm at index', data.buttonIndex)
                                                      },
                                                      onFail : function(err) {
                                                      log('hidePreloader called failed', err) },
                                                      onCancel : function(err) { log('user canceled', err) }
                                                      })
                 }
            //设置导航栏标题
            var navigationTitleButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 navigationTitleButton.innerHTML = 'setTitle'
                 navigationTitleButton.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.navigation.setTitle({
                                                title : '邮箱正文',//控制标题文本，空表示显示默认文本
                                                onSuccess : function(result) {
                                                log('setTitle Success, user confirm at Index ',data.buttonIndex)
                                                },
                                                onFail : function(err) {
                                                log('=======setTitle Failed=======:',err.error)
                                                }
                                                });
                 }
            //设置导航栏图标
            var navigationIconButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 navigationIconButton.innerHTML = 'setIcon'
                 navigationIconButton.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.navigation.setIcon({
                                           showIcon : true,//是否显示icon
                                           iconIndex : 3,//显示的iconIndex
                                           onSuccess : function(result) {
                                           log('setIcon Success, user confirm at Index ',data.buttonIndex)
                                           },
                                           onFail : function(err) {
                                           log('=======setIcon Failed=======:',err.error)
                                           }
                                           });
                 }
             //设置导航栏左侧按钮
             var navigationLeftButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 navigationLeftButton.innerHTML = 'setLeft'
                 navigationLeftButton.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.navigation.setLeft({
                                           show: true,//控制按钮显示， true 显示， false 隐藏， 默认true
                                           control: true,//是否控制点击事件，true 控制，false 不控制， 默认false
                                           showIcon: true,//是否显示icon，true 显示， false 不显示，默认true； 注：具体UI以客户端为准
                                           text: '',//控制显示文本，空字符串表示显示默认文本
                                           onSuccess : function(result) {
                                           //如果control为true，则onSuccess将在发生按钮点击事件被回调
                                           },
                                           onFail : function(err) {}
                                           });
                 }
            //设置浏览器关闭按钮
            var closeButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 closeButton.innerHTML = 'close'
                 closeButton.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.navigation.close({
                                         onSuccess : function(result) {
                                         },
                                         onFail : function(err) {}
                                         })
                 }
            //设置导航栏右侧单个按钮
            var navigationRightSingleButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 navigationRightSingleButton.innerHTML = 'setRight'
                 navigationRightSingleButton.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.navigation.setRight({
                                            show: true,//控制按钮显示， true 显示， false 隐藏， 默认true
                                            control: true,//是否控制点击事件，true 控制，false 不控制， 默认false
                                            text: '发送',//控制显示文本，空字符串表示显示默认文本
                                            onSuccess : function(result) {
                                            //如果control为true，则onSuccess将在发生按钮点击事件被回调
                                            },
                                            onFail : function(err) {}
                                            });
                 }
            //设置导航栏右侧多个按钮
            var navigationRightSeriesButtons = document.getElementById('buttons').appendChild(document.createElement('button'))
                 navigationRightSeriesButtons.innerHTML = 'setMenu'
                 navigationRightSeriesButtons.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.navigation.setMenu({
                                           backgroundColor : "#ADD8E6",
                                           items : [
                                                    {
                                                    "id":"1",//字符串
                                                    "iconId":"file",//字符串，图标命名
                                                    "text":"帮助"
                                                    },
                                                    {
                                                    "id":"2",
                                                    "iconId":"photo",
                                                    "text":"dierge"
                                                    },
                                                    {
                                                    "id":"3",
                                                    "iconId":"setting",
                                                    "text":"disange",
                                                    },
                                                    {
                                                    "id":"4",
                                                    "iconId":"time",
                                                    "text":"disige"
                                                    }
                                            ],
                                           onSuccess: function(data) {
                                           },
                                           onFail: function(err) {
                                           }
                                           });
                 }
                 
            //电话
            var telephoneButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 telephoneButton.innerHTML = 'call'
                 telephoneButton.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.telephone.call({
                                       users: ['101', '102'], //用户列表，工号
                                       corpId: '', //企业id
                                       onSuccess : function() {},
                                       onFail : function() {}
                                       })
                 }
                 
            //扫码
            var scanButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 scanButton.innerHTML = 'scan'
                 scanButton.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.util.scan({
                                  type: 'qrCode',//type为qrCode或者barCode
                                  onSuccess: function(data) {
                                  // data结构{ 'text': String}
                                  log('success scan result is:',data.text)
                                  },
                                  onFail : function(err) {
                                  log('=======scan Failed=======:',err.error)
                                  }
                                  })
                 
                 }
            //启动器
            var checkInstalledAppsButtton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 checkInstalledAppsButtton.innerHTML = 'checkInstalledApps'
                 checkInstalledAppsButtton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.launcher.checkInstalledApps({
                                                       apps: ['taobao', 'tmall'], //iOS:应用scheme;Android:应用包名
                                                       onSuccess : function(data) {
                                                       /*
                                                        {
                                                        installed: ['taobao', 'tmall'] //iOS:应用scheme;Android:应用包名
                                                        }
                                                        */
                                                       },
                                                       onFail : function(err) {}
                                                       })
                 }
            //启动第三方应用
            var  launchAppButton = document.getElementById('buttons').appendChild(document. createElement('button'))
                 launchAppButton.innerHTML = 'launcherApp'
                 launchAppButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.launcher.launchApp({
                                              app: 'taobao', //iOS:应用scheme;Android:应用包名
                                              activity :'DetailActivity', //仅限Android，打开指定Activity，可不传。如果为空，就打开App的Main入口Activity
                                              onSuccess : function(data) {
                                              /*
                                               {
                                               result: true //true 唤起成功 false 唤起失败
                                               }
                                               */
                                              },
                                              onFail : function(err) {}
                                              });
                 }
            //获取当前网络状况
             var  getNetworkTypeButton = document.getElementById('buttons').appendChild(document. createElement('button'))
             getNetworkTypeButton.innerHTML = 'getNetworkType'
             getNetworkTypeButton.onclick = function(e) {
             e.preventDefault()
                 dd.device.connection.getNetworkType({
                                                     onSuccess : function(data) {
                                                     /*
                                                      {
                                                      result: 'wifi' // result值: wifi 2g 3g 4g unknown none   none表示离线
                                                      }
                                                      */
                                                     },
                                                     onFail : function(err) {}
                                                     });
             }
                 
            //事件
            /*     //退到后台(webview)
                 document.addEventListener('pause', function(e) {
                                           e.preventDefault();
                                           console.log('事件：pause')
                                           }, false);
                 
                 //唤醒(webview)
                 document.addEventListener('resume', function(e) {
                                           e.preventDefault();
                                           console.log('事件：resume')
                                           }, false);
            
            */
                 //开始录音
                 var startRecordButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 startRecordButton.innerHTML = 'startRecord'
                 startRecordButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.audio.startRecord({
                                             onSuccess : function () {
                                             },
                                             onFail : function (err) {
                                             }
                                             });
                 }
                 //停止录音
                 var stopRecordButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 stopRecordButton.innerHTML = 'stopRecord'
                 stopRecordButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.audio.stopRecord({
                                            onSuccess : function(res){
                                            res.mediaId; // 返回音频的MediaID，可用于本地播放和音频下载
                                            res.duration; // 返回音频的时长，单位：秒
                                            },
                                            onFail : function (err) {
                                            }
                                            });
                 }
                 
            //监听录音自动停止
            var onRecordEndButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 onRecordEndButton.innerHTML = 'onRecordEnd'
                 onRecordEndButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.audio.onRecordEnd({
                                             onSuccess : function(res) {
                                             res.mediaId; // 停止播放音频MediaID
                                             res.duration; // 返回音频的时长，单位：秒
                                             },
                                             onFail : function (err) {
                                             
                                             }
                                             });
                 }
            //下载音频
            var downloadButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 downloadButton.innerHTML = 'download'
                 downloadButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.audio.download({
                                          mediaId : "@lATOCLhLfc46kUl8zlUmRlM",
                                          onSuccess : function(res) {
                                          res.localAudioId;
                                          },
                                          onFail : function (err) {
                                          }
                                          });
                 }
            //播放语音
            var playButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 playButton.innerHTML = 'play'
                 playButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.audio.play({
                                      localAudioId : "localAudioId",
                                      
                                      onSuccess : function () {
                                      
                                      },
                                      
                                      onFail : function (err) {
                                      }
                                      });
                 }
            //暂停播放语音
            var pauseButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 pauseButton.innerHTML = 'pause'
                 pauseButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.audio.pause({
                                       localAudioId : "localAudioId",
                                       onSuccess : function() {
                                       },
                                       onFail : function(err) {
                                       }
                                       });
                 }
            //恢复暂停播放的语音
             var resumeButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 resumeButton.innerHTML = 'resume'
                 resumeButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.audio.resume({
                                        localAudioId : "localAudioId",
                                        onSuccess : function() {
                                        },
                                        onFail : function(err) {
                                        }
                                        });
             }
            //停止播放
            var stopButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 stopButton.innerHTML = 'stop'
                 stopButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.audio.stop({
                                      localAudioId : "localAudioId",
                                      onSuccess : function (res) {
                                      },
                                      onFail : function () {
                                      }
                                      });
                 }
            //监听播放自动停止
            var onPlayEndButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 onPlayEndButton.innerHTML = 'onPlayEnd'
                 onPlayEndButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.audio.onPlayEnd({
                                           onSuccess : function (res) {
                                           res.localAudioId;
                                           },
                                           onFail : function (err) {
                                           }
                                           });
                 }
            //语音转文字接口
                 
             var translateVoiceButton = document.getElementById('buttons').appendChild(document.createElement('button'))
                 translateVoiceButton.innerHTML = 'translateVoice'
                 translateVoiceButton.onclick = function(e) {
                 e.preventDefault()
                 dd.device.audio.translateVoice({
                                                mediaId : "@lATOCLhLfc46kUl8zlUmRlM",
                                                duration : 5.0,
                                                onSuccess : function (res) {
                                                //res.mediaId;// 转换的语音的mediaId-->-->
                                                //res.content; // 语音转换的文字内容
                                                },
                                                });
                 }

                 
            //地图功能：定位
            var mapLocate = document.getElementById('buttons').appendChild(document.createElement('button'))
                 mapLocate.innerHTML = 'mapLocate'
                 mapLocate.onclick = function(e) {
                 e.preventDefault()
                 log('=======Start=======')

                 dd.biz.map.locate({
                                           onSuccess : function(result) {
                                           },
                                           onFail : function(err) {
                                           }
                                           });
                 }
                 
            //地图功能：POI搜索
            var mapPOISearch = document.getElementById('buttons').appendChild(document.createElement('button'))
                 mapPOISearch.innerHTML = 'mapSearch'
                 mapPOISearch.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.map.search({
                                   onSuccess : function(result) {
                                   },
                                   onFail : function(err) {}
                                   });
                 }
                 
            //基础功能：获取SSID和MAC地址
            var getInterface = document.getElementById('buttons').appendChild(document.createElement('button'))
                 getInterface.innerHTML = 'getInterface'
                 getInterface.onclick = function(e) {
                 e.preventDefault()
                 dd.device.base.getInterface({
                                             onSuccess : function(data) {
                                             /*
                                              {
                                              ssid: 'alibaba-inc',
                                              macIp: '3c:12:aa:09'
                                              }
                                              */
                                             },
                                             onFail : function(err) {}
                                             });
                 }
                 
            //UI控件：输入框
            var plain = document.getElementById('buttons').appendChild(document.createElement('button'))
                 plain.innerHTML = 'plain'
                 plain.onclick = function(e) {
                 e.preventDefault()
                 dd.ui.input.plain({
                                   placeholder: '说点什么吧', //占位符
                                   text: '', //默认填充文本
                                   onSuccess: function(data) {
                                   //onSuccess将在点击发送之后调用
                                   /*{
                                    text: String
                                    }*/
                                   },
                                   onFail: function() {
                                   
                                   }
                                   })
                 }
            //UI控件：progressView Color
            var setColors = document.getElementById('buttons').appendChild(document.createElement('button'))
                 setColors.innerHTML = 'progressColors'
                 setColors.onclick = function(e) {
                 e.preventDefault()
                 dd.ui.progressBar.setColors({
                                   colors: ['#FF0000','#000093','#F9F900','#6C3365'], //array[number] 进度条变化颜色，最多支持4个颜色
                                   onSuccess: function(data) {
                                   //onSuccess将在点击发送之后调用
                                   /*{
                                    text: String
                                    }*/
                                   },
                                   onFail: function() {
                                   }
                                   })
                 }
                 
            //UI控件：下拉刷新－启用
            var setColors = document.getElementById('buttons').appendChild(document.createElement('button'))
                 setColors.innerHTML = 'refreshEnable'
                 setColors.onclick = function(e) {
                 e.preventDefault()
                 dd.ui.pullToRefresh.enable({
                                            onSuccess: function() {
                                            },
                                            onFail: function() {
                                            }
                                            })
                 }
                 
        //UI控件：下拉刷新－停止
                 var setColors = document.getElementById('buttons').appendChild(document.createElement('button'))
                 setColors.innerHTML = 'refreshStop'
                 setColors.onclick = function(e) {
                 e.preventDefault()
                 dd.ui.pullToRefresh.stop({
                                             onSuccess: function(data) {
                                             },
                                             onFail: function() {
                                             }
                                             })
                 }
        //UI控件：下拉刷新－禁用
        var setColors = document.getElementById('buttons').appendChild(document.createElement('button'))
                 setColors.innerHTML = 'refreshDisable'
                 setColors.onclick = function(e) {
                 e.preventDefault()
                 dd.ui.pullToRefresh.disable({

                                          onSuccess: function(data) {
                                          },
                                          onFail: function() {
                                          }
                                          })
                 }
        //UI控件：webViewBounce－启用
        var setColors = document.getElementById('buttons').appendChild(document.createElement('button'))
                 setColors.innerHTML = 'BounceEnable'
                 setColors.onclick = function(e) {
                 e.preventDefault()
                 dd.ui.webViewBounce.enable({
                                             
                                             onSuccess: function(data) {
                                             },
                                             onFail: function() {
                                             }
                                             })
                 }
        //UI控件：webViewBounce－禁用
        var setColors = document.getElementById('buttons').appendChild(document.createElement('button'))
                 setColors.innerHTML = 'BounceDisable'
                 setColors.onclick = function(e) {
                 e.preventDefault()
                 dd.ui.webViewBounce.disable({
                                             
                                             onSuccess: function(data) {
                                             },
                                             onFail: function() {
                                             }
                                             })
                 }
        //通用JSAPI接口获取用户信息
        var setColors = document.getElementById('buttons').appendChild(document.createElement('button'))
                 setColors.innerHTML = 'JSAPIGet'
                 setColors.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.user.get({
                                 onSuccess: function (info) {
                                 log('userGet success: ' + JSON.stringify(info), 'success');
                                 },
                                 onFail: function (err) {
                                 log('userGet fail: ' + JSON.stringify(err));
                                 }
                                 });
                 }
                 //客户端加密
                 var setColors = document.getElementById('buttons').appendChild(document.createElement('button'))
                 setColors.innerHTML = 'getUserInfo'
                 setColors.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.user.getUserInfo({
                                 onSuccess: function (info) {
                                 log('getUserInfo success: ' + JSON.stringify(info), 'success');
                                 },
                                 onFail: function (err) {
                                 log('getUserInfo fail: ' + JSON.stringify(err));
                                 }
                                 });
                 }
        //客户端加密
        var setColors = document.getElementById('buttons').appendChild(document.createElement('button'))
                 setColors.innerHTML = 'encrypt'
                 setColors.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.util.encrypt({
                                     corpId:'test',//必传,
                                     data: {//要加密的数据
                                     h :'hello',
                                     w : 'world'
                                     },
                                     
                                     onSuccess: function(data) {
                                     log.i('encrypt: ' + JSON.stringify(data));
                                     
                                     },
                                     onFail: function(err) {
                                     log.e('encrypt err: ' + JSON.stringify(err));
                                     
                                     }
                                     });
                 }
        //客户端解密
        var setColors = document.getElementById('buttons').appendChild(document.createElement('button'))
                 setColors.innerHTML = 'decrypt'
                 setColors.onclick = function(e) {
                 e.preventDefault()
                 dd.biz.util.decrypt({
                                     corpId:'test',//
                                     data: {
                                     h :'1_1_29ae62f3a655aecd14b639a5aa50d3408e21c1ff668c71ea78f3d5cc340a9880',
                                     w :'1_1_62983a28e92e59e2d889eb6bbba872cc141dd7b495e7a076847125fe70472e1e'
                                     },
                                     
                                     onSuccess: function(data) {
                                     log.i('encrypt: ' + JSON.stringify(data));
                                     
                                     },
                                     onFail: function(err) {
                                     log.e('encrypt err: ' + JSON.stringify(err));
                                     
                                     }
                                     })
                 }
                 
            })
            
        </script>
    <div id='buttons'></div> <div id='log'></div>
</body></html>
