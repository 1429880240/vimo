"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function noop(){}function selfFulfillment(){return new TypeError("You cannot resolve a promise with itself")}function cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}function getThen(e){try{return e.then}catch(e){return GET_THEN_ERROR.error=e,GET_THEN_ERROR}}function tryThen(e,r,t,n){try{e.call(r,t,n)}catch(e){return e}}function handleForeignThenable(e,r,t){(0,_asap.asap)(function(e){var n=!1,o=tryThen(t,r,function(t){n||(n=!0,r!==t?resolve(e,t):fulfill(e,t))},function(r){n||(n=!0,reject(e,r))},"Settle: "+(e._label||" unknown promise"));!n&&o&&(n=!0,reject(e,o))},e)}function handleOwnThenable(e,r){r._state===FULFILLED?fulfill(e,r._result):r._state===REJECTED?reject(e,r._result):subscribe(r,void 0,function(r){return resolve(e,r)},function(r){return reject(e,r)})}function handleMaybeThenable(e,r,t){r.constructor===e.constructor&&t===_then2.default&&r.constructor.resolve===_resolve2.default?handleOwnThenable(e,r):t===GET_THEN_ERROR?reject(e,GET_THEN_ERROR.error):void 0===t?fulfill(e,r):(0,_utils.isFunction)(t)?handleForeignThenable(e,r,t):fulfill(e,r)}function resolve(e,r){e===r?reject(e,selfFulfillment()):(0,_utils.objectOrFunction)(r)?handleMaybeThenable(e,r,getThen(r)):fulfill(e,r)}function publishRejection(e){e._onerror&&e._onerror(e._result),publish(e)}function fulfill(e,r){e._state===PENDING&&(e._result=r,e._state=FULFILLED,0!==e._subscribers.length&&(0,_asap.asap)(publish,e))}function reject(e,r){e._state===PENDING&&(e._state=REJECTED,e._result=r,(0,_asap.asap)(publishRejection,e))}function subscribe(e,r,t,n){var o=e._subscribers,s=o.length;e._onerror=null,o[s]=r,o[s+FULFILLED]=t,o[s+REJECTED]=n,0===s&&e._state&&(0,_asap.asap)(publish,e)}function publish(e){var r=e._subscribers,t=e._state;if(0!==r.length){for(var n=void 0,o=void 0,s=e._result,i=0;i<r.length;i+=3)n=r[i],o=r[i+t],n?invokeCallback(t,n,o,s):o(s);e._subscribers.length=0}}function ErrorObject(){this.error=null}function tryCatch(e,r){try{return e(r)}catch(e){return TRY_CATCH_ERROR.error=e,TRY_CATCH_ERROR}}function invokeCallback(e,r,t,n){var o=(0,_utils.isFunction)(t),s=void 0,i=void 0,l=void 0,u=void 0;if(o){if(s=tryCatch(t,n),s===TRY_CATCH_ERROR?(u=!0,i=s.error,s=null):l=!0,r===s)return void reject(r,cannotReturnOwn())}else s=n,l=!0;r._state!==PENDING||(o&&l?resolve(r,s):u?reject(r,i):e===FULFILLED?fulfill(r,s):e===REJECTED&&reject(r,s))}function initializePromise(e,r){try{r(function(r){resolve(e,r)},function(r){reject(e,r)})}catch(r){reject(e,r)}}function nextId(){return id++}function makePromise(e){e[PROMISE_ID]=id++,e._state=void 0,e._result=void 0,e._subscribers=[]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleMaybeThenable=exports.PENDING=exports.REJECTED=exports.FULFILLED=exports.invokeCallback=exports.initializePromise=exports.publishRejection=exports.publish=exports.subscribe=exports.fulfill=exports.reject=exports.resolve=exports.noop=exports.getThen=exports.makePromise=exports.nextId=exports.PROMISE_ID=void 0;var _utils=require("./utils"),_asap=require("./asap"),_then=require("./then"),_then2=_interopRequireDefault(_then),_resolve=require("./promise/resolve"),_resolve2=_interopRequireDefault(_resolve),PROMISE_ID=exports.PROMISE_ID=Math.random().toString(36).substring(16),PENDING=void 0,FULFILLED=1,REJECTED=2,GET_THEN_ERROR=new ErrorObject,TRY_CATCH_ERROR=new ErrorObject,id=0;exports.nextId=nextId,exports.makePromise=makePromise,exports.getThen=getThen,exports.noop=noop,exports.resolve=resolve,exports.reject=reject,exports.fulfill=fulfill,exports.subscribe=subscribe,exports.publish=publish,exports.publishRejection=publishRejection,exports.initializePromise=initializePromise,exports.invokeCallback=invokeCallback,exports.FULFILLED=FULFILLED,exports.REJECTED=REJECTED,exports.PENDING=PENDING,exports.handleMaybeThenable=handleMaybeThenable;