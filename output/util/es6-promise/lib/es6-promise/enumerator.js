"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function Enumerator(e,t){this._instanceConstructor=e,this.promise=new e(_internal.noop),this.promise[_internal.PROMISE_ID]||(0,_internal.makePromise)(this.promise),(0,_utils.isArray)(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?(0,_internal.fulfill)(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&(0,_internal.fulfill)(this.promise,this._result))):(0,_internal.reject)(this.promise,validationError())}function validationError(){return new Error("Array Methods must be provided an Array")}Object.defineProperty(exports,"__esModule",{value:!0});var _utils=require("./utils"),_internal=require("./-internal"),_then2=require("./then"),_then3=_interopRequireDefault(_then2),_promise=require("./promise"),_promise2=_interopRequireDefault(_promise),_resolve=require("./promise/resolve"),_resolve2=_interopRequireDefault(_resolve);exports.default=Enumerator,Enumerator.prototype._enumerate=function(){for(var e=this.length,t=this._input,r=0;this._state===_internal.PENDING&&r<e;r++)this._eachEntry(t[r],r)},Enumerator.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,i=r.resolve;if(i===_resolve2.default){var n=(0,_internal.getThen)(e);if(n===_then3.default&&e._state!==_internal.PENDING)this._settledAt(e._state,t,e._result);else if("function"!=typeof n)this._remaining--,this._result[t]=e;else if(r===_promise2.default){var s=new r(_internal.noop);(0,_internal.handleMaybeThenable)(s,e,n),this._willSettleAt(s,t)}else this._willSettleAt(new r(function(t){return t(e)}),t)}else this._willSettleAt(i(e),t)},Enumerator.prototype._settledAt=function(e,t,r){var i=this.promise;i._state===_internal.PENDING&&(this._remaining--,e===_internal.REJECTED?(0,_internal.reject)(i,r):this._result[t]=r),0===this._remaining&&(0,_internal.fulfill)(i,this._result)},Enumerator.prototype._willSettleAt=function(e,t){var r=this;(0,_internal.subscribe)(e,void 0,function(e){return r._settledAt(_internal.FULFILLED,t,e)},function(e){return r._settledAt(_internal.REJECTED,t,e)})};