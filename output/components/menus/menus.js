"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function recordMenuInstance(e){var t=(0,_getPrototypeOf2.default)((0,_getPrototypeOf2.default)(e));t.$menus||(t.$menus=new Menus),t.$menus.record(e)}Object.defineProperty(exports,"__esModule",{value:!0});var _promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require("babel-runtime/helpers/createClass"),_createClass3=_interopRequireDefault(_createClass2),_getPrototypeOf=require("babel-runtime/core-js/reflect/get-prototype-of"),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);exports.recordMenuInstance=recordMenuInstance;var _util=require("../../util/util"),Menus=function(){function e(){(0,_classCallCheck3.default)(this,e),this.currentMenuId=null,this.menuIns={},this._unReg=null}return(0,_createClass3.default)(e,[{key:"record",value:function(e){this.menuIns[e.id]=e}},{key:"open",value:function(e){function t(e,t){e.menuIns[t]?(e.currentMenuId=t,e.menuIns[t].openMenu(),!!u&&u()):!!r&&r(),e._unReg&&e._unReg(),e._unReg=(0,_util.urlChange)(function(){e.close()})}var n=this,u=void 0,r=void 0;return this.currentMenuId?this.close().then(function(){window.setTimeout(function(){t(n,e)},160)}):t(this,e),new _promise2.default(function(e,t){u=e,r=t})}},{key:"close",value:function(){var e=this,t=this.currentMenuId,n=void 0,u=void 0;return t?(this.currentMenuId=null,this.menuIns[t]?this.menuIns[t].closeMenu().then(function(){n&&n()}):u&&u()):u&&u(),new _promise2.default(function(t,r){e._unReg&&e._unReg(),n=t,u=r})}},{key:"toggle",value:function(e){return this.currentMenuId?this.close():this.open(e)}}]),e}();