"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ModalFactory(e){return new Modal({el:(0,_getInsertPosition.getInsertPosition)("modalPortal").appendChild(document.createElement("div")),propsData:e})}function present(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};navState=1;var t=e.template,n=e.modalData,r=e.onDismiss,i=e.name||"",o=e.mode||"",a=e.position||"bottom",s=ModalFactory({name:i,position:a,mode:o}),l=s._present(),u=_vue2.default.extend(t),d=void 0,m=s.$el.querySelectorAll(".modalPageLoadPort")[0].appendChild(document.createElement("div"));return window.setTimeout(function(){d=new u({el:m,modalData:n}),window.history.pushState({id:d._uid},"","")},0),modalArr.push({modalInstance:s,template:e.template,templateInstance:d,modalData:n,onDismiss:r}),0==unRegisterUrlChange.length&&(0,_util.registerListener)(window,"popstate",function(){if(0===navState){var e=modalArr.pop();e&&e.modalInstance._dismiss(),0===modalArr.length&&unregisterAllListener()}},{},unRegisterUrlChange),window.setTimeout(function(){navState=0},400),l}function dismiss(e){return new _promise2.default(function(t){navState=1;var n=modalArr.pop(),r=n.modalInstance;0===modalArr.length&&unregisterAllListener(),window.history.back(-1),r._dismiss().then(function(){navState=0,n.onDismiss&&n.onDismiss(e),t()})})}function unregisterAllListener(){unRegisterUrlChange.forEach(function(e){return e&&e()}),unRegisterUrlChange=[]}Object.defineProperty(exports,"__esModule",{value:!0});var _promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise),_vue=require("vue"),_vue2=_interopRequireDefault(_vue),_modal=require("./modal.vue"),_modal2=_interopRequireDefault(_modal),_util=require("../../util/util"),_getInsertPosition=require("../../util/getInsertPosition"),modalArr=[],unRegisterUrlChange=[],Modal=_vue2.default.extend(_modal2.default),navState=0;exports.default={present:present,dismiss:dismiss};