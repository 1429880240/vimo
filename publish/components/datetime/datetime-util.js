"use strict";function renderDateTime(e,t,r){if((0,_util.isBlank)(t))return"";var i=[],a=!1;if(FORMAT_KEYS.forEach(function(n,s){if(e.indexOf(n.f)>-1){var o="{"+s+"}",u=renderTextFormat(n.f,t[n.k],t,r);!a&&u&&(0,_util.isPresent)(t[n.k])&&(a=!0),i.push(o,u),e=e.replace(n.f,o)}}),!a)return"";for(var n=0;n<i.length;n+=2)e=e.replace(i[n],i[n+1]);return e}function renderTextFormat(e,t,r,i){if(e===FORMAT_DDDD||e===FORMAT_DDD){try{return t=new Date(r.year,r.month-1,r.day).getDay(),e===FORMAT_DDDD?((0,_util.isPresent)(i.dayNames)?i.dayNames:DAY_NAMES)[t]:((0,_util.isPresent)(i.dayShortNames)?i.dayShortNames:DAY_SHORT_NAMES)[t]}catch(e){}return""}if(e===FORMAT_A)return r?r.hour<12?"AM":"PM":(0,_util.isPresent)(t)?t.toUpperCase():"";if(e===FORMAT_a)return r?r.hour<12?"am":"pm":(0,_util.isPresent)(t)?t:"";if((0,_util.isBlank)(t))return"";if(e===FORMAT_YY||e===FORMAT_MM||e===FORMAT_DD||e===FORMAT_HH||e===FORMAT_mm||e===FORMAT_ss)return twoDigit(t);if(e===FORMAT_YYYY)return fourDigit(t);if(e===FORMAT_MMMM)return((0,_util.isPresent)(i.monthNames)?i.monthNames:MONTH_NAMES)[t-1];if(e===FORMAT_MMM)return((0,_util.isPresent)(i.monthShortNames)?i.monthShortNames:MONTH_SHORT_NAMES)[t-1];if(e===FORMAT_hh||e===FORMAT_h){if(0===t)return"12";if(t>12&&(t-=12),e===FORMAT_hh&&t<10)return"0"+t}return t.toString()}function dateValueRange(e,t,r){var i=[],a=void 0;if(e===FORMAT_YYYY||e===FORMAT_YY)for(a=r.year;a>=t.year;)i.push(a--);else if(e===FORMAT_MMMM||e===FORMAT_MMM||e===FORMAT_MM||e===FORMAT_M||e===FORMAT_hh||e===FORMAT_h)for(a=1;a<13;a++)i.push(a);else if(e===FORMAT_DDDD||e===FORMAT_DDD||e===FORMAT_DD||e===FORMAT_D)for(a=1;a<32;a++)i.push(a);else if(e===FORMAT_HH||e===FORMAT_H)for(a=0;a<24;a++)i.push(a);else if(e===FORMAT_mm||e===FORMAT_m)for(a=0;a<60;a++)i.push(a);else if(e===FORMAT_ss||e===FORMAT_s)for(a=0;a<60;a++)i.push(a);else e!==FORMAT_A&&e!==FORMAT_a||i.push("am","pm");return i}function dateSortValue(e,t,r){return parseInt("1"+fourDigit(e)+twoDigit(t)+twoDigit(r),10)}function dateDataSortValue(e){return e?dateSortValue(e.year,e.month,e.day):-1}function daysInMonth(e,t){return 4===e||6===e||9===e||11===e?30:2===e?isLeapYear(t)?29:28:31}function isLeapYear(e){return e%4==0&&e%100!=0||e%400==0}function parseDate(e){var t=void 0;if((0,_util.isPresent)(e)){if(""!==e&&(t=TIME_REGEXP.exec(e),(0,_util.isPresent)(t)?(t.unshift(void 0,void 0),t[2]=t[3]=void 0):t=ISO_8601_REGEXP.exec(e),(0,_util.isBlank)(t))){var r=new Date(e);(0,_util.isPresent)(r)&&(e=r)}"date"===Object.prototype.toString.call(e).match(/^(\[object )(\w+)\]$/i)[2].toLowerCase()&&(t=["",e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()])}if((0,_util.isBlank)(t))return null;for(var i=1;i<8;i++)t[i]=void 0!==t[i]?parseInt(t[i],10):null;var a=0;return(0,_util.isPresent)(t[9])&&(0,_util.isPresent)(t[10])&&(a=60*parseInt(t[10],10),(0,_util.isPresent)(t[11])&&(a+=parseInt(t[11],10)),"-"===t[9]&&(a*=-1)),{year:t[1],month:t[2],day:t[3],hour:t[4],minute:t[5],second:t[6],millisecond:t[7],tzOffset:a}}function updateDate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];if(!e&&(e={}),(0,_util.isPresent)(t)&&""!==t){if((0,_util.isString)(t)||(0,_util.isDate)(t)){if(t=parseDate(t))return Object.assign(e,t),e}else if((0,_util.isPresent)(t.year)||(0,_util.isPresent)(t.hour)||(0,_util.isPresent)(t.month)||(0,_util.isPresent)(t.day)||(0,_util.isPresent)(t.minute)||(0,_util.isPresent)(t.second)){(0,_util.isPresent)(t.ampm)&&(0,_util.isPresent)(t.hour)&&("pm"===t.ampm.value?t.hour.value=12===t.hour.value?12:t.hour.value+12:t.hour.value=12===t.hour.value?0:t.hour.value);for(var r in t)e[r]=t[r].value;return e}console.warn('Error parsing date: "'+t+'". Please provide a valid ISO 8601 datetime format: https://www.w3.org/TR/NOTE-datetime')}else for(var i in e)delete e[i];return e}function parseTemplate(e){var t=[];e=e.replace(/[^\w\s]/gi," "),FORMAT_KEYS.forEach(function(t){t.f.length>1&&e.indexOf(t.f)>-1&&e.indexOf(t.f+t.f.charAt(0))<0&&(e=e.replace(t.f," "+t.f+" "))});var r=e.split(" ").filter(function(e){return e.length>0});return r.forEach(function(e,i){FORMAT_KEYS.forEach(function(a){if(e===a.f){if((e===FORMAT_A||e===FORMAT_a)&&(t.indexOf(FORMAT_h)<0&&t.indexOf(FORMAT_hh)<0||-1===VALID_AMPM_PREFIX.indexOf(r[i-1])))return;t.push(e)}})}),t}function getValueFromFormat(e,t){return t===FORMAT_A||t===FORMAT_a?e.hour<12?"am":"pm":t===FORMAT_hh||t===FORMAT_h?e.hour>12?e.hour-12:e.hour:e[convertFormatToKey(t)]}function convertFormatToKey(e){for(var t in FORMAT_KEYS)if(FORMAT_KEYS[t].f===e)return FORMAT_KEYS[t].k;return null}function convertDataToISO(e){var t="";return(0,_util.isPresent)(e)&&((0,_util.isPresent)(e.year)?(t=fourDigit(e.year),(0,_util.isPresent)(e.month)&&(t+="-"+twoDigit(e.month),(0,_util.isPresent)(e.day)&&(t+="-"+twoDigit(e.day),(0,_util.isPresent)(e.hour)&&(t+="T"+twoDigit(e.hour)+":"+twoDigit(e.minute)+":"+twoDigit(e.second),e.millisecond>0&&(t+="."+threeDigit(e.millisecond)),(0,_util.isBlank)(e.tzOffset)||0===e.tzOffset?t+="Z":t+=(e.tzOffset>0?"+":"-")+twoDigit(Math.floor(e.tzOffset/60))+":"+twoDigit(e.tzOffset%60))))):(0,_util.isPresent)(e.hour)&&(t=twoDigit(e.hour)+":"+twoDigit(e.minute),(0,_util.isPresent)(e.second)&&(t+=":"+twoDigit(e.second),(0,_util.isPresent)(e.millisecond)&&(t+="."+threeDigit(e.millisecond))))),t}function twoDigit(e){return("0"+((0,_util.isPresent)(e)?Math.abs(e):"0")).slice(-2)}function threeDigit(e){return("00"+((0,_util.isPresent)(e)?Math.abs(e):"0")).slice(-3)}function fourDigit(e){return("000"+((0,_util.isPresent)(e)?Math.abs(e):"0")).slice(-4)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.renderDateTime=renderDateTime,exports.renderTextFormat=renderTextFormat,exports.dateValueRange=dateValueRange,exports.dateSortValue=dateSortValue,exports.dateDataSortValue=dateDataSortValue,exports.daysInMonth=daysInMonth,exports.isLeapYear=isLeapYear,exports.parseDate=parseDate,exports.updateDate=updateDate,exports.parseTemplate=parseTemplate,exports.getValueFromFormat=getValueFromFormat,exports.convertFormatToKey=convertFormatToKey,exports.convertDataToISO=convertDataToISO;var _util=require("../../util/util"),FORMAT_YYYY="YYYY",FORMAT_YY="YY",FORMAT_MMMM="MMMM",FORMAT_MMM="MMM",FORMAT_MM="MM",FORMAT_M="M",FORMAT_DDDD="DDDD",FORMAT_DDD="DDD",FORMAT_DD="DD",FORMAT_D="D",FORMAT_HH="HH",FORMAT_H="H",FORMAT_hh="hh",FORMAT_h="h",FORMAT_mm="mm",FORMAT_m="m",FORMAT_ss="ss",FORMAT_s="s",FORMAT_A="A",FORMAT_a="a",FORMAT_KEYS=[{f:FORMAT_YYYY,k:"year"},{f:FORMAT_MMMM,k:"month"},{f:FORMAT_DDDD,k:"day"},{f:FORMAT_MMM,k:"month"},{f:FORMAT_DDD,k:"day"},{f:FORMAT_YY,k:"year"},{f:FORMAT_MM,k:"month"},{f:FORMAT_DD,k:"day"},{f:FORMAT_HH,k:"hour"},{f:FORMAT_hh,k:"hour"},{f:FORMAT_mm,k:"minute"},{f:FORMAT_ss,k:"second"},{f:FORMAT_M,k:"month"},{f:FORMAT_D,k:"day"},{f:FORMAT_H,k:"hour"},{f:FORMAT_h,k:"hour"},{f:FORMAT_m,k:"minute"},{f:FORMAT_s,k:"second"},{f:FORMAT_A,k:"ampm"},{f:FORMAT_a,k:"ampm"}],DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],DAY_SHORT_NAMES=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"],MONTH_SHORT_NAMES=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],VALID_AMPM_PREFIX=[FORMAT_hh,FORMAT_h,FORMAT_mm,FORMAT_m,FORMAT_ss,FORMAT_s],ISO_8601_REGEXP=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,TIME_REGEXP=/^((\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/;